class CreditsScene extends Phaser.Scene {
    constructor() {
        super('CreditsScene');
    }

    create() {
        this.sound.stopAll();
        this.sound.play('credits_music', { loop: true, volume: 0.5 });
        this.add.image(400, 300, 'scuola_di_atene').setScale(0.7).setAlpha(0.4);

        const creditsTextContent = [
            'Paideia', '(Alla scuola di atene)', '', '',
            'Un Progetto Realizzato Da:', '', '',
            'Christian Rongo', '[ Game Developer ]', '',
            'Francesco Maffettone', '[ Concept Creator ]', '',
            'Pasquale Muriello', '[ Art Designer ]', '', '', '',
            'Un Ringraziamento Speciale ai Pensatori:', '',
            'Platone', 'Aristotele', 'Diogene', 'Socrate', 'Pitagora', '', '', '',
            'Hanno partecipato al progetto anche:', '',
            'Panico Christian', 'Valerio D\'Alconzo', 'Palladino Gabriele', 'Daniele Napolitano',
            'Fusaro Mario', 'Zito Giovanni', 'Luca Lombardi', 'Manila Signore',
            'Adriano Gabriele', 'Alessandro de Falco', 'Testa Daniele',
            'Davide Sorrentino', 'Giuseppe Di Mauro', 'Marco Aprea', '', '', '',
            'Musiche:', '',
            '"On The Heavens" by Thoribass',
            '"Refuge of the Survivors" by Scott Buckley',
            '"The Introvert" by Michael Kobrin (from Pixabay)', '', '', '',
            'ITI E. BARSANTI - POMIGLIANO D\'ARCO', 'Classe 4B', '', '',
            'Grazie per aver giocato!',
        ];

        const creditsContainer = this.add.container(400, 600);
        const normalStyle = { fontSize: '28px', fill: '#E0D6B3', fontFamily: '"Cinzel", serif', align: 'center' };
        const highlightStyle = { fontSize: '32px', fill: '#E0D6B3', fontFamily: '"Cinzel", serif', align: 'center' };
        let currentY = 0;
        const lineSpacing = 45;
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <title>Paideia - Alla Scuola di Atene</title>
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.60.0/dist/phaser.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; background: #000; }
    </style>
</head>
<body>
    <script src="scenes/UIScene.js?v=FINAL"></script>
    <script src="scenes/GameScene.js?v=FINAL"></script>
    <script src="scenes/TitleScene.js?v=FINAL"></script>
    <script src="scenes/CreditsScene.js?v=FINAL"></script>
    <script src="scenes/IntroScene.js?v=FINAL"></script>
    <script src="scenes/VictoryScene.js?v=FINAL"></script>

    <script>
    class Preloader extends Phaser.Scene {
        constructor() { super('Preloader'); }
        preload() {
            let progressBar = this.add.graphics();
            let progressBox = this.add.graphics();
            progressBox.fillStyle(0x222222, 0.8);
            progressBox.fillRect(240, 270, 320, 50);
            this.load.on('progress', (value) => {
                progressBar.clear();
                progressBar.fillStyle(0xffffff, 1);
                progressBar.fillRect(250, 280, 300 * value, 30);
            });
            this.add.text(400, 240, 'Caricamento...', { fontSize: '24px', fill: '#fff' }).setOrigin(0.5);

            // Video e Immagini
            this.load.video('menu_bg_video', 'assets/video/menu_background.mp4', 'loadeddata', false, true);
            this.load.image('platone', 'assets/img/platone.png');
            this.load.image('aristotele', 'assets/img/aristotele.png');
            this.load.image('diogene', 'assets/img/diogene.png');
            this.load.image('player', 'assets/img/player.png');
            this.load.image('socrate', 'assets/img/socrate.png');
            this.load.image('pitagora', 'assets/img/pitagora.png');
            this.load.image('scuola_di_atene', 'assets/img/scuola_di_atene.jpg');
            
            // Audio con nomi originali
            this.load.audio('bgm', 'assets/audio/On_the_Nature_of_Daylight.mp3'); 
            this.load.audio('menu_music', 'assets/audio/On_The_Heavens.mp3');
            this.load.audio('credits_music', 'assets/audio/Refuge_Of_The_Survivors.mp3');
            this.load.audio('correct_sfx', 'assets/audio/correct.mp3');
            this.load.audio('wrong_sfx', 'assets/audio/wrong.mp3');
            this.load.audio('footsteps', 'assets/audio/footstep_on_bricks.mp3');
            this.load.audio('narrator', 'assets/audio/narrator.mp3');
            this.load.audio('victory_sound', 'assets/audio/Victory.mp3');
        }
        create() { this.scene.start('TitleScene'); }
    }
    const config = {
        type: Phaser.AUTO,
        width: 800,
        height: 600,
        physics: {
            default: 'arcade',
            arcade: { gravity: { y: 0 }, debug: false }
        },
        scene: [Preloader, TitleScene, IntroScene, GameScene, UIScene, VictoryScene, CreditsScene]
    };
    const game = new Phaser.Game(config);
    </script>
</body>
</html>
        creditsTextContent.forEach(line => {
            let style = normalStyle;
            if (line === 'Christian Rongo' || line === '[ Game Developer ]') {
                style = highlightStyle;
            }
            const textLine = this.add.text(0, currentY, line, style).setOrigin(0.5);
            creditsContainer.add(textLine);
            currentY += lineSpacing;
        });

        // --- LOGICA DI SCORRIMENTO CORRETTA ---
        this.tweens.add({
            targets: creditsContainer,
            y: -creditsContainer.height, // Fa scorrere l'intero contenitore fino a farlo uscire in alto
            duration: 30000, // Durata di 30 secondi
            ease: 'Linear',
            
            // onComplete si attiva SOLO quando l'animazione Ã¨ veramente finita
            onComplete: () => {
                const restartButton = this.add.text(400, 550, '[ Torna al Menu Principale ]', {
                    fontSize: '24px',
                    fill: '#c5a65a',
                    fontFamily: '"Cinzel", serif'
                }).setOrigin(0.5).setInteractive({ useHandCursor: true });

                restartButton.on('pointerover', () => restartButton.setStyle({ fill: '#FFFFFF' }));
                restartButton.on('pointerout', () => restartButton.setStyle({ fill: '#c5a65a' }));

                restartButton.on('pointerdown', () => {
                    this.sound.stopAll();
                    this.cameras.main.fadeOut(500, 0, 0, 0);
                    this.cameras.main.once(Phaser.Cameras.Scene2D.Events.FADE_OUT_COMPLETE, () => {
                        this.scene.start('TitleScene');
                    });
                });
            }
        });
    }
}

